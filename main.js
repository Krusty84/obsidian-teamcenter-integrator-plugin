/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => TeamcenterIntegratorPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian4 = require("obsidian");

// src/mainWindow.ts
var import_obsidian2 = require("obsidian");

// src/tcAPI.ts
var import_obsidian = require("obsidian");
var TeamcenterApi = class {
  constructor(settings) {
    this.jsessionId = null;
    this.settings = settings;
  }
  updateSettings(settings) {
    this.settings = settings;
  }
  // @ts-ignore
  async login(tcUrl = this.settings.tcUrl, tcUrlWebTierPort = this.settings.tcUrlWebTierPort, tcWebTierAppName = this.settings.tcWebTierAppName, userName = this.settings.userName, userPassword = this.settings.userPassword) {
    this.jsessionId = "";
    const url = `${tcUrl}:${tcUrlWebTierPort}/${tcWebTierAppName}/JsonRestServices/Core-2011-06-Session/login`;
    const payload = {
      header: {
        state: {},
        policy: {}
      },
      body: {
        credentials: {
          user: userName,
          password: userPassword,
          role: "",
          descrimator: "",
          locale: "",
          group: ""
        }
      }
    };
    const requestOptions = {
      url,
      method: "POST",
      contentType: "application/json",
      body: JSON.stringify(payload),
      headers: {
        "Content-Type": "application/json"
      },
      throw: false
    };
    try {
      const response = await (0, import_obsidian.requestUrl)(requestOptions);
      if (!response.json.code) {
        const setCookieHeader = response.headers["set-cookie"];
        if (setCookieHeader) {
          let cookieString = "";
          if (Array.isArray(setCookieHeader)) {
            cookieString = setCookieHeader.join("; ");
          } else {
            cookieString = setCookieHeader;
          }
          const jsessionIdMatch = cookieString.match(/JSESSIONID=([^;]+)/);
          if (jsessionIdMatch) {
            this.jsessionId = jsessionIdMatch[1];
            console.log("Logged in successfully. JSESSIONID:", this.jsessionId);
            return this.jsessionId;
          } else {
            console.error("JSESSIONID not found in Set-Cookie header.");
          }
        } else {
          console.error("Set-Cookie header not found in response.");
        }
      } else {
        console.error("Login failed. Status:", response.status, "Response:", response.text);
        return "500";
      }
    } catch (error) {
      console.error("An error occurred during login:", error);
      return error;
    }
  }
  async loadRevisionRule(tcUrl = this.settings.tcUrl, tcUrlWebTierPort = this.settings.tcUrlWebTierPort, tcWebTierAppName = this.settings.tcWebTierAppName) {
    var _a, _b, _c;
    if (!this.jsessionId) {
      console.error("Not logged in. Please login first.");
      throw new Error("Not logged in");
    }
    const url = `${tcUrl}:${tcUrlWebTierPort}/${tcWebTierAppName}/JsonRestServices/Cad-2007-01-StructureManagement/getRevisionRules`;
    const payload = {
      "header": {
        "state": {
          "formatProperties": true,
          "stateless": true,
          "unloadObjects": false,
          "enableServerStateHeaders": true,
          "locale": "en_US"
        },
        "policy": {
          "types": [
            {
              "name": "RevisionRule",
              "properties": [
                {
                  "name": "object_name"
                }
              ]
            }
          ]
        }
      }
    };
    const requestOptions = {
      url,
      method: "POST",
      contentType: "application/json",
      body: JSON.stringify(payload),
      headers: {
        "Content-Type": "application/json",
        "Cookie": `JSESSIONID=${this.jsessionId}`
      },
      throw: false
    };
    try {
      const response = await (0, import_obsidian.requestUrl)(requestOptions);
      if (response.status === 200) {
        const data = response.json;
        const revisionRules = [];
        const outputArray = data.output;
        const modelObjects = (_a = data.ServiceData) == null ? void 0 : _a.modelObjects;
        if (!Array.isArray(outputArray) || !modelObjects) {
          console.error("Unexpected response format");
          throw new Error("Unexpected response format");
        }
        for (const outputItem of outputArray) {
          const revRuleUid = (_b = outputItem.revRule) == null ? void 0 : _b.uid;
          if (revRuleUid && modelObjects[revRuleUid]) {
            const revRuleObject = modelObjects[revRuleUid];
            const objectNameProps = (_c = revRuleObject.props) == null ? void 0 : _c.object_name;
            const uiValues = objectNameProps == null ? void 0 : objectNameProps.uiValues;
            const name = uiValues && uiValues[0] ? uiValues[0] : "";
            if (name) {
              revisionRules.push({ uid: revRuleUid, name });
            } else {
              console.warn(`No name found for revision rule with UID ${revRuleUid}`);
            }
          } else {
            console.warn(`Revision rule with UID ${revRuleUid} not found in modelObjects`);
          }
        }
        return revisionRules;
      } else {
        console.error("Failed to load revision rules. Status:", response.status, "Response:", response.text);
        throw new Error("Failed to load revision rules");
      }
    } catch (error) {
      console.error("An error occurred while loading revision rules:", error);
      throw error;
    }
  }
  // Future methods will use this.jsessionId for authenticated requests
};

// src/mainWindow.ts
var TeamcenterModal = class extends import_obsidian2.Modal {
  constructor(app, settings) {
    super(app);
    this.revisionRules = [];
    this.selectedRevisionRuleUid = null;
    this.selectedRevisionRule = null;
    this.itemId = "";
    this.settings = settings;
  }
  async onOpen() {
    const { contentEl } = this;
    this.teamcenterApi = new TeamcenterApi(this.settings);
    contentEl.createEl("h2", { text: "Teamcenter Query" });
    let dropdownEventAttached = false;
    new import_obsidian2.Setting(contentEl).setName("Revision Rule").addDropdown((dropdown) => {
      dropdown.addOption("", "Select a revision rule");
      if (!dropdownEventAttached) {
        dropdownEventAttached = true;
        dropdown.selectEl.addEventListener("mousedown", async (event) => {
          if (this.revisionRules.length === 0) {
            event.preventDefault();
            dropdown.addOption("", "Loading...");
            dropdown.setValue("");
            dropdown.selectEl.disabled = true;
            try {
              this.revisionRules = await this.teamcenterApi.loadRevisionRule();
              dropdown.addOption("", "Select a revision rule");
              for (const rule of this.revisionRules) {
                dropdown.addOption(rule.uid, rule.name);
              }
              dropdown.selectEl.disabled = false;
              dropdown.selectEl.click();
            } catch (error) {
              console.error("Failed to load revision rules:", error);
              dropdown.addOption("", "Failed to load revision rules");
              dropdown.setValue("");
              dropdown.selectEl.disabled = false;
            }
          }
        });
      }
      dropdown.onChange((value) => {
        this.selectedRevisionRuleUid = value;
      });
    });
    new import_obsidian2.Setting(contentEl).setName("Item ID").addText((text) => {
      text.setPlaceholder("Enter Item ID").onChange((value) => {
        this.itemId = value;
      });
    });
    new import_obsidian2.Setting(contentEl).addButton((button) => {
      button.setButtonText("Submit").setCta().onClick(async () => {
        await this.teamcenterApi.login();
      });
    });
    new import_obsidian2.Setting(contentEl).addButton((button) => {
      button.setButtonText("Cancel").onClick(() => {
        this.close();
      });
    });
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
  submit() {
    console.log("Selected Revision Rule:", this.selectedRevisionRule);
    console.log("Item ID:", this.itemId);
    this.close();
  }
};

// src/settings.ts
var import_obsidian3 = require("obsidian");
var DEFAULT_SETTINGS = {
  tcUrl: "",
  tcUrlWebTierPort: "7001",
  tcWebTierAppName: "tc",
  userName: "",
  userPassword: "",
  selectedRevisionRuleUid: "",
  selectedRevisionRuleName: ""
};
var TeamcenterIntegratorSettingTab = class extends import_obsidian3.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.revisionRules = [];
    this.selectedRevisionRuleUid = null;
    this.selectedRevisionRule = null;
    this.plugin = plugin;
  }
  display() {
    let revisionRuleControl;
    let dropdownEventAttached = false;
    const { containerEl } = this;
    const teamcenterApi = new TeamcenterApi(DEFAULT_SETTINGS);
    containerEl.empty();
    containerEl.createEl("h2", { text: "Teamcenter Integration Settings" });
    new import_obsidian3.Setting(containerEl).setName("TC_URL").setDesc("Base URL of your Teamcenter server.").addText((text) => text.setPlaceholder("Enter TC_URL").setValue(this.plugin.settings.tcUrl).onChange(async (value) => {
      this.plugin.settings.tcUrl = value.trim();
      await this.plugin.saveSettings();
    }));
    new import_obsidian3.Setting(containerEl).setName("TCURL_WEBTIER_APP_NAME").setDesc("Web tier application name (typically: tc).").addText((text) => text.setPlaceholder("Enter TCURL_WEBTIER_APP_NAME").setValue(this.plugin.settings.tcWebTierAppName).onChange(async (value) => {
      this.plugin.settings.tcWebTierAppName = value.trim();
      await this.plugin.saveSettings();
    }));
    new import_obsidian3.Setting(containerEl).setName("TCURL_WEBTIER_PORT").setDesc("Web tier port of your Teamcenter server (typically: 7001).").addText((text) => text.setPlaceholder("Enter TCURL_WEBTIER_PORT").setValue(this.plugin.settings.tcUrlWebTierPort).onChange(async (value) => {
      this.plugin.settings.tcUrlWebTierPort = value.trim();
      await this.plugin.saveSettings();
    }));
    new import_obsidian3.Setting(containerEl).setName("User Name").setDesc("Your Teamcenter username.").addText((text) => text.setPlaceholder("Enter your username").setValue(this.plugin.settings.userName).onChange(async (value) => {
      this.plugin.settings.userName = value.trim();
      await this.plugin.saveSettings();
    }));
    new import_obsidian3.Setting(containerEl).setName("Password").setDesc("Your Teamcenter password.").addText((text) => {
      text.setPlaceholder("Enter your password").setDisabled(true).setValue(this.plugin.settings.userPassword).onChange(async (value) => {
        this.plugin.settings.userPassword = value.trim();
        await this.plugin.saveSettings();
      });
    });
    new import_obsidian3.Setting(containerEl).addButton((button) => {
      button.setButtonText("Check Teamcenter login/password").setCta().onClick(async () => {
        try {
          await teamcenterApi.login(
            this.plugin.settings.tcUrl,
            this.plugin.settings.tcUrlWebTierPort,
            this.plugin.settings.tcWebTierAppName,
            this.plugin.settings.userName,
            this.plugin.settings.userPassword
          ).then((loginResult) => {
            console.log("loginResult: " + loginResult);
            if (loginResult !== "500") {
              revisionRuleControl.setDisabled(false);
            }
          });
        } catch (error) {
          revisionRuleControl.setDisabled(true);
        }
      });
    });
    new import_obsidian3.Setting(containerEl).setName("Revision Rule").addDropdown((dropdown) => {
      revisionRuleControl = dropdown;
      if (this.plugin.settings.selectedRevisionRuleName) {
        dropdown.addOption(this.plugin.settings.selectedRevisionRuleUid, this.plugin.settings.selectedRevisionRuleName);
      } else {
        dropdown.addOption("", "Select a revision rule");
      }
      dropdown.setDisabled(true);
      if (this.revisionRules && this.revisionRules.length > 0) {
        populateDropdownWithRevisionRules(dropdown, this.revisionRules);
        if (this.plugin.settings.selectedRevisionRuleUid) {
          dropdown.setValue(this.plugin.settings.selectedRevisionRuleUid);
        }
        dropdown.setDisabled(false);
      } else {
        if (!dropdownEventAttached) {
          dropdownEventAttached = true;
          dropdown.selectEl.addEventListener("mousedown", async (event) => {
            if (!this.revisionRules || this.revisionRules.length === 0) {
              event.preventDefault();
              dropdown.addOption("", "Loading...");
              dropdown.setValue("");
              dropdown.selectEl.disabled = true;
              try {
                this.revisionRules = await teamcenterApi.loadRevisionRule(
                  this.plugin.settings.tcUrl,
                  this.plugin.settings.tcUrlWebTierPort,
                  this.plugin.settings.tcWebTierAppName
                );
                populateDropdownWithRevisionRules(dropdown, this.revisionRules);
                dropdown.selectEl.disabled = false;
                dropdown.selectEl.click();
                if (this.plugin.settings.selectedRevisionRuleUid) {
                  dropdown.setValue(this.plugin.settings.selectedRevisionRuleUid);
                }
              } catch (error) {
                console.error("Failed to load revision rules:", error);
                dropdown.addOption("", "Failed to load revision rules");
                dropdown.setValue("");
                dropdown.selectEl.disabled = false;
              }
            }
          });
        }
      }
      dropdown.onChange(async (value) => {
        this.plugin.settings.selectedRevisionRuleUid = value;
        const selectedRule = this.revisionRules.find((rule) => rule.uid === value);
        this.plugin.settings.selectedRevisionRuleName = selectedRule ? selectedRule.name : "";
        await this.plugin.saveSettings();
      });
    });
    function populateDropdownWithRevisionRules(dropdown, revisionRules) {
      dropdown.selectEl.innerHTML = "";
      dropdown.addOption("", "Select a revision rule");
      for (const rule of revisionRules) {
        dropdown.addOption(rule.uid, rule.name);
      }
    }
  }
};

// main.ts
var TeamcenterIntegratorPlugin = class extends import_obsidian4.Plugin {
  async onload() {
    await this.loadSettings();
    const ribbonIconEl = this.addRibbonIcon("dice", "Sample Plugin", async (evt) => {
      new import_obsidian4.Notice("This is a notice!");
      new TeamcenterModal(this.app, this.settings).open();
    });
    ribbonIconEl.addClass("my-plugin-ribbon-class");
    this.addSettingTab(new TeamcenterIntegratorSettingTab(this.app, this));
  }
  onunload() {
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  async buildHierarchy() {
    const folders = [
      "FolderA",
      "FolderA/FolderB",
      "FolderA/FolderB/FolderC"
    ];
    for (const folder of folders) {
      await this.createFolderIfNotExists(folder);
    }
    const notes = [
      {
        path: "FolderA/NoteA.md",
        data: {
          "Name": "Note A",
          "Description": "Description for Note A",
          "Owner": "Alice",
          "Date": "2023-10-14"
        }
      },
      {
        path: "FolderA/FolderB/NoteB.md",
        data: {
          "Name": "Note B",
          "Description": "Description for Note B",
          "Owner": "Bob",
          "Date": "2023-10-15"
        }
      }
    ];
    for (const note of notes) {
      const content = this.generateTable(note.data);
      await this.createNoteIfNotExists(note.path, content);
    }
  }
  async createFolderIfNotExists(folderPath) {
    folderPath = (0, import_obsidian4.normalizePath)(folderPath);
    if (!this.app.vault.getAbstractFileByPath(folderPath)) {
      await this.app.vault.createFolder(folderPath);
    }
  }
  async createNoteIfNotExists(notePath, content) {
    notePath = (0, import_obsidian4.normalizePath)(notePath);
    if (!this.app.vault.getAbstractFileByPath(notePath)) {
      await this.app.vault.create(notePath, content);
    }
  }
  generateTable(data) {
    const headers = "| Field       | Value                |\n|-------------|----------------------|\n";
    let rows = "";
    for (const key in data) {
      rows += `| ${key}        | ${data[key]}          |
`;
    }
    return headers + rows;
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvdGVhbWNlbnRlck1vZGFsLnRzIiwgInNyYy90ZWFtY2VudGVyQXBpLnRzIiwgInNyYy9zZXR0aW5ncy50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgTm90aWNlLCBQbHVnaW4sbm9ybWFsaXplUGF0aCB9IGZyb20gJ29ic2lkaWFuJztcblxuLy8gUmVtZW1iZXIgdG8gcmVuYW1lIHRoZXNlIGNsYXNzZXMgYW5kIGludGVyZmFjZXMhXG5cbmltcG9ydCBUZWFtY2VudGVyQXBpIGZyb20gJy4vc3JjL3RlYW1jZW50ZXJBcGknO1xuaW1wb3J0IHtUZWFtY2VudGVyTW9kYWx9IGZyb20gXCIuL3NyYy90ZWFtY2VudGVyTW9kYWxcIjtcbmltcG9ydCB7IERFRkFVTFRfU0VUVElOR1MsIFRlYW1jZW50ZXJJbnRlZ3JhdG9yU2V0dGluZ1RhYn0gZnJvbSAnc3JjL3NldHRpbmdzJ1xuXG5leHBvcnQgaW50ZXJmYWNlIFRlYW1jZW50ZXJJbnRlZ3JhdG9yUGx1Z2luU2V0dGluZ3Mge1xuXHR0Y1VybDogc3RyaW5nO1xuXHR0Y1VybFdlYlRpZXJQb3J0OiBzdHJpbmc7XG5cdHRjV2ViVGllckFwcE5hbWU6c3RyaW5nO1xuXHR1c2VyTmFtZTogc3RyaW5nO1xuXHR1c2VyUGFzc3dvcmQ6IHN0cmluZztcblx0c2VsZWN0ZWRSZXZpc2lvblJ1bGVOYW1lOnN0cmluZztcblx0c2VsZWN0ZWRSZXZpc2lvblJ1bGVVaWQ6c3RyaW5nO1xufVxuXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFRlYW1jZW50ZXJJbnRlZ3JhdG9yUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcblx0c2V0dGluZ3M6IFRlYW1jZW50ZXJJbnRlZ3JhdG9yUGx1Z2luU2V0dGluZ3M7XG5cdHRlYW1jZW50ZXJBcGk6IFRlYW1jZW50ZXJBcGk7XG5cdGFzeW5jIG9ubG9hZCgpIHtcblx0XHRhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xuXG5cdFx0Ly8gSW5pdGlhbGl6ZSBUZWFtY2VudGVyIEFQSSB3aXRoIHNldHRpbmdzXG5cdFx0Ly90aGlzLnRlYW1jZW50ZXJBcGkgPSBuZXcgVGVhbWNlbnRlckFwaSh0aGlzLnNldHRpbmdzKTtcblxuXHRcdC8vIFRoaXMgY3JlYXRlcyBhbiBpY29uIGluIHRoZSBsZWZ0IHJpYmJvbi5cblx0XHRjb25zdCByaWJib25JY29uRWwgPSB0aGlzLmFkZFJpYmJvbkljb24oJ2RpY2UnLCAnU2FtcGxlIFBsdWdpbicsIGFzeW5jIChldnQ6IE1vdXNlRXZlbnQpID0+IHtcblx0XHRcdC8vIENhbGxlZCB3aGVuIHRoZSB1c2VyIGNsaWNrcyB0aGUgaWNvbi5cblx0XHRcdG5ldyBOb3RpY2UoJ1RoaXMgaXMgYSBub3RpY2UhJyk7XG5cdFx0XHQvKmF3YWl0IHRoaXMuYnVpbGRIaWVyYXJjaHkoKTsqL1xuXG5cdFx0XHRuZXcgVGVhbWNlbnRlck1vZGFsKHRoaXMuYXBwLCB0aGlzLnNldHRpbmdzKS5vcGVuKCk7XG5cblx0XHR9KTtcblx0XHQvLyBQZXJmb3JtIGFkZGl0aW9uYWwgdGhpbmdzIHdpdGggdGhlIHJpYmJvblxuXHRcdHJpYmJvbkljb25FbC5hZGRDbGFzcygnbXktcGx1Z2luLXJpYmJvbi1jbGFzcycpO1xuXG5cdFx0Ly8gVGhpcyBhZGRzIGEgc3RhdHVzIGJhciBpdGVtIHRvIHRoZSBib3R0b20gb2YgdGhlIGFwcC4gRG9lcyBub3Qgd29yayBvbiBtb2JpbGUgYXBwcy5cblx0XHQvKmNvbnN0IHN0YXR1c0Jhckl0ZW1FbCA9IHRoaXMuYWRkU3RhdHVzQmFySXRlbSgpO1xuXHRcdHN0YXR1c0Jhckl0ZW1FbC5zZXRUZXh0KCdTdGF0dXMgQmFyIFRleHQnKTsqL1xuXG5cdFx0Ly8gVGhpcyBhZGRzIGEgc2ltcGxlIGNvbW1hbmQgdGhhdCBjYW4gYmUgdHJpZ2dlcmVkIGFueXdoZXJlIChDdHJsK1ApXG4vKlx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0aWQ6ICdvcGVuLXNhbXBsZS1tb2RhbC1zaW1wbGUnLFxuXHRcdFx0bmFtZTogJ09wZW4gc2FtcGxlIG1vZGFsIChzaW1wbGUpJyxcblx0XHRcdGNhbGxiYWNrOiAoKSA9PiB7XG5cdFx0XHRcdG5ldyBTYW1wbGVNb2RhbCh0aGlzLmFwcCkub3BlbigpO1xuXHRcdFx0fVxuXHRcdH0pOyovXG5cblx0XHQvLyBUaGlzIGFkZHMgYSBzZXR0aW5ncyB0YWIgc28gdGhlIHVzZXIgY2FuIGNvbmZpZ3VyZSB2YXJpb3VzIGFzcGVjdHMgb2YgdGhlIHBsdWdpblxuXHRcdHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgVGVhbWNlbnRlckludGVncmF0b3JTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XG5cdH1cblxuXHRvbnVubG9hZCgpIHtcblxuXHR9XG5cblx0YXN5bmMgbG9hZFNldHRpbmdzKCkge1xuXHRcdHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpO1xuXHR9XG5cblx0YXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuXHRcdGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XG5cdFx0Ly8gVXBkYXRlIFRlYW1jZW50ZXIgQVBJIHNldHRpbmdzXG5cdFx0Ly90aGlzLnRlYW1jZW50ZXJBcGkudXBkYXRlU2V0dGluZ3ModGhpcy5zZXR0aW5ncyk7XG5cdH1cblxuXHRhc3luYyBidWlsZEhpZXJhcmNoeSgpIHtcblx0XHRjb25zdCBmb2xkZXJzID0gW1xuXHRcdFx0J0ZvbGRlckEnLFxuXHRcdFx0J0ZvbGRlckEvRm9sZGVyQicsXG5cdFx0XHQnRm9sZGVyQS9Gb2xkZXJCL0ZvbGRlckMnXG5cdFx0XTtcblxuXHRcdGZvciAoY29uc3QgZm9sZGVyIG9mIGZvbGRlcnMpIHtcblx0XHRcdGF3YWl0IHRoaXMuY3JlYXRlRm9sZGVySWZOb3RFeGlzdHMoZm9sZGVyKTtcblx0XHR9XG5cblx0XHRjb25zdCBub3RlcyA9IFtcblx0XHRcdHtcblx0XHRcdFx0cGF0aDogJ0ZvbGRlckEvTm90ZUEubWQnLFxuXHRcdFx0XHRkYXRhOiB7XG5cdFx0XHRcdFx0J05hbWUnOiAnTm90ZSBBJyxcblx0XHRcdFx0XHQnRGVzY3JpcHRpb24nOiAnRGVzY3JpcHRpb24gZm9yIE5vdGUgQScsXG5cdFx0XHRcdFx0J093bmVyJzogJ0FsaWNlJyxcblx0XHRcdFx0XHQnRGF0ZSc6ICcyMDIzLTEwLTE0J1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXHRcdFx0e1xuXHRcdFx0XHRwYXRoOiAnRm9sZGVyQS9Gb2xkZXJCL05vdGVCLm1kJyxcblx0XHRcdFx0ZGF0YToge1xuXHRcdFx0XHRcdCdOYW1lJzogJ05vdGUgQicsXG5cdFx0XHRcdFx0J0Rlc2NyaXB0aW9uJzogJ0Rlc2NyaXB0aW9uIGZvciBOb3RlIEInLFxuXHRcdFx0XHRcdCdPd25lcic6ICdCb2InLFxuXHRcdFx0XHRcdCdEYXRlJzogJzIwMjMtMTAtMTUnXG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRdO1xuXG5cdFx0Zm9yIChjb25zdCBub3RlIG9mIG5vdGVzKSB7XG5cdFx0XHRjb25zdCBjb250ZW50ID0gdGhpcy5nZW5lcmF0ZVRhYmxlKG5vdGUuZGF0YSk7XG5cdFx0XHRhd2FpdCB0aGlzLmNyZWF0ZU5vdGVJZk5vdEV4aXN0cyhub3RlLnBhdGgsIGNvbnRlbnQpO1xuXHRcdH1cblx0fVxuXG5cdGFzeW5jIGNyZWF0ZUZvbGRlcklmTm90RXhpc3RzKGZvbGRlclBhdGg6IHN0cmluZykge1xuXHRcdGZvbGRlclBhdGggPSBub3JtYWxpemVQYXRoKGZvbGRlclBhdGgpO1xuXHRcdGlmICghdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZvbGRlclBhdGgpKSB7XG5cdFx0XHRhd2FpdCB0aGlzLmFwcC52YXVsdC5jcmVhdGVGb2xkZXIoZm9sZGVyUGF0aCk7XG5cdFx0fVxuXHR9XG5cblx0YXN5bmMgY3JlYXRlTm90ZUlmTm90RXhpc3RzKG5vdGVQYXRoOiBzdHJpbmcsIGNvbnRlbnQ6IHN0cmluZykge1xuXHRcdG5vdGVQYXRoID0gbm9ybWFsaXplUGF0aChub3RlUGF0aCk7XG5cdFx0aWYgKCF0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgobm90ZVBhdGgpKSB7XG5cdFx0XHRhd2FpdCB0aGlzLmFwcC52YXVsdC5jcmVhdGUobm90ZVBhdGgsIGNvbnRlbnQpO1xuXHRcdH1cblx0fVxuXG5cdGdlbmVyYXRlVGFibGUoZGF0YTogeyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfSk6IHN0cmluZyB7XG5cdFx0Y29uc3QgaGVhZGVycyA9ICd8IEZpZWxkICAgICAgIHwgVmFsdWUgICAgICAgICAgICAgICAgfFxcbnwtLS0tLS0tLS0tLS0tfC0tLS0tLS0tLS0tLS0tLS0tLS0tLS18XFxuJztcblx0XHRsZXQgcm93cyA9ICcnO1xuXHRcdGZvciAoY29uc3Qga2V5IGluIGRhdGEpIHtcblx0XHRcdHJvd3MgKz0gYHwgJHtrZXl9ICAgICAgICB8ICR7ZGF0YVtrZXldfSAgICAgICAgICB8XFxuYDtcblx0XHR9XG5cdFx0cmV0dXJuIGhlYWRlcnMgKyByb3dzO1xuXHR9XG59XG5cbiIsICIvLyBUZWFtY2VudGVyTW9kYWwudHNcblxuaW1wb3J0IHsgQXBwLE1vZGFsLCBTZXR0aW5nIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IFRlYW1jZW50ZXJBcGkgZnJvbSAnLi90ZWFtY2VudGVyQXBpJztcbmltcG9ydCB7UmV2aXNpb25SdWxlfSBmcm9tIFwiLi90ZWFtY2VudGVyQXBpXCI7XG4vL2ltcG9ydCB7VGVhbWNlbnRlckludGVncmF0b3JQbHVnaW5TZXR0aW5nc30gZnJvbSAnc3JjL3NldHRpbmdzJ1xuaW1wb3J0IHsgVGVhbWNlbnRlckludGVncmF0b3JQbHVnaW5TZXR0aW5ncyB9IGZyb20gJ21haW4nO1xuZXhwb3J0IGNsYXNzIFRlYW1jZW50ZXJNb2RhbCBleHRlbmRzIE1vZGFsIHtcbiAgICAvL3NldHRpbmdzOiBUZWFtY2VudGVySW50ZWdyYXRvclBsdWdpblNldHRpbmdzO1xuICAgIHRlYW1jZW50ZXJBcGk6IFRlYW1jZW50ZXJBcGk7XG4gICAgcHJpdmF0ZSByZXZpc2lvblJ1bGVzOiBSZXZpc2lvblJ1bGVbXSA9IFtdO1xuICAgIHByaXZhdGUgc2VsZWN0ZWRSZXZpc2lvblJ1bGVVaWQ6IHN0cmluZyB8IG51bGwgPSBudWxsO1xuICAgIHByaXZhdGUgc2VsZWN0ZWRSZXZpc2lvblJ1bGU6IHN0cmluZyB8IG51bGwgPSBudWxsO1xuICAgIHByaXZhdGUgaXRlbUlkID0gXCJcIjtcbiAgICBwcml2YXRlIHNldHRpbmdzOiBUZWFtY2VudGVySW50ZWdyYXRvclBsdWdpblNldHRpbmdzO1xuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLHNldHRpbmdzOiBUZWFtY2VudGVySW50ZWdyYXRvclBsdWdpblNldHRpbmdzKSB7XG4gICAgICAgIHN1cGVyKGFwcCk7XG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBzZXR0aW5ncztcbiAgICB9XG5cbiAgICBhc3luYyBvbk9wZW4oKSB7XG4gICAgICAgIGNvbnN0IHtjb250ZW50RWx9ID0gdGhpcztcbiAgICAgICAgdGhpcy50ZWFtY2VudGVyQXBpID0gbmV3IFRlYW1jZW50ZXJBcGkodGhpcy5zZXR0aW5ncyk7XG4gICAgICAgIGNvbnRlbnRFbC5jcmVhdGVFbCgnaDInLCB7dGV4dDogJ1RlYW1jZW50ZXIgUXVlcnknfSk7XG5cbiAgICAgICAgLy8gRHJvcGRvd24gZm9yIFJldmlzaW9uIFJ1bGVcbiAgICAgICAgbGV0IGRyb3Bkb3duRXZlbnRBdHRhY2hlZCA9IGZhbHNlO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdSZXZpc2lvbiBSdWxlJylcbiAgICAgICAgICAgIC5hZGREcm9wZG93bihkcm9wZG93biA9PiB7XG4gICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKCcnLCAnU2VsZWN0IGEgcmV2aXNpb24gcnVsZScpO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFkcm9wZG93bkV2ZW50QXR0YWNoZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgZHJvcGRvd25FdmVudEF0dGFjaGVkID0gdHJ1ZTtcblxuICAgICAgICAgICAgICAgICAgICBkcm9wZG93bi5zZWxlY3RFbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCBhc3luYyAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnJldmlzaW9uUnVsZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsgLy8gUHJldmVudCB0aGUgZHJvcGRvd24gZnJvbSBvcGVuaW5nXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2Ryb3Bkb3duLmNsZWFyT3B0aW9ucygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbignJywgJ0xvYWRpbmcuLi4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkcm9wZG93bi5zZXRWYWx1ZSgnJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZHJvcGRvd24uc2VsZWN0RWwuZGlzYWJsZWQgPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXZpc2lvblJ1bGVzID0gYXdhaXQgdGhpcy50ZWFtY2VudGVyQXBpLmxvYWRSZXZpc2lvblJ1bGUoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2Ryb3Bkb3duLmNsZWFyT3B0aW9ucygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oJycsICdTZWxlY3QgYSByZXZpc2lvbiBydWxlJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBydWxlIG9mIHRoaXMucmV2aXNpb25SdWxlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKHJ1bGUudWlkLCBydWxlLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHJvcGRvd24uc2VsZWN0RWwuZGlzYWJsZWQgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBPcGVuIHRoZSBkcm9wZG93biBhZnRlciBsb2FkaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRyb3Bkb3duLnNlbGVjdEVsLmNsaWNrKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gbG9hZCByZXZpc2lvbiBydWxlczonLCBlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vZHJvcGRvd24uY2xlYXJPcHRpb25zKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbignJywgJ0ZhaWxlZCB0byBsb2FkIHJldmlzaW9uIHJ1bGVzJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRyb3Bkb3duLnNldFZhbHVlKCcnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHJvcGRvd24uc2VsZWN0RWwuZGlzYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFJldmlzaW9uUnVsZVVpZCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gVGV4dCBmaWVsZCBmb3IgSXRlbSBJRFxuICAgICAgICBuZXcgU2V0dGluZyhjb250ZW50RWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnSXRlbSBJRCcpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHtcbiAgICAgICAgICAgICAgICB0ZXh0LnNldFBsYWNlaG9sZGVyKCdFbnRlciBJdGVtIElEJylcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaXRlbUlkID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gU3VibWl0IGJ1dHRvblxuICAgICAgICBuZXcgU2V0dGluZyhjb250ZW50RWwpXG4gICAgICAgICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiB7XG4gICAgICAgICAgICAgICAgYnV0dG9uLnNldEJ1dHRvblRleHQoJ1N1Ym1pdCcpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRDdGEoKVxuICAgICAgICAgICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnRlYW1jZW50ZXJBcGkubG9naW4oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5zdWJtaXQoKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAvLyBDYW5jZWwgYnV0dG9uXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcbiAgICAgICAgICAgIC5hZGRCdXR0b24oYnV0dG9uID0+IHtcbiAgICAgICAgICAgICAgICBidXR0b24uc2V0QnV0dG9uVGV4dCgnQ2FuY2VsJylcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIG9uQ2xvc2UoKSB7XG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTtcbiAgICB9XG5cbiAgICBzdWJtaXQoKSB7XG4gICAgICAgIC8vIEhhbmRsZSB0aGUgZm9ybSBzdWJtaXNzaW9uXG4gICAgICAgIGNvbnNvbGUubG9nKCdTZWxlY3RlZCBSZXZpc2lvbiBSdWxlOicsIHRoaXMuc2VsZWN0ZWRSZXZpc2lvblJ1bGUpO1xuICAgICAgICBjb25zb2xlLmxvZygnSXRlbSBJRDonLCB0aGlzLml0ZW1JZCk7XG5cbiAgICAgICAgLy8gUGVyZm9ybSBhbnkgYWN0aW9ucyB3aXRoIHRoZSBkYXRhIGhlcmVcblxuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuXG59XG4iLCAiLy8gVGVhbWNlbnRlckFwaS50c1xuXG5pbXBvcnQgeyByZXF1ZXN0VXJsLCBSZXF1ZXN0VXJsUGFyYW0sIFJlcXVlc3RVcmxSZXNwb25zZSB9IGZyb20gJ29ic2lkaWFuJztcblxuaW50ZXJmYWNlIFRlYW1jZW50ZXJJbnRlZ3JhdG9yUGx1Z2luU2V0dGluZ3Mge1xuICAgIHRjVXJsOiBzdHJpbmc7XG4gICAgdGNVcmxXZWJUaWVyUG9ydDogc3RyaW5nO1xuICAgIHRjV2ViVGllckFwcE5hbWU6c3RyaW5nO1xuICAgIHVzZXJOYW1lOiBzdHJpbmc7XG4gICAgdXNlclBhc3N3b3JkOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmV2aXNpb25SdWxlIHtcbiAgICB1aWQ6IHN0cmluZztcbiAgICBuYW1lOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFRlYW1jZW50ZXJBcGkge1xuICAgIHByaXZhdGUgc2V0dGluZ3M6IFRlYW1jZW50ZXJJbnRlZ3JhdG9yUGx1Z2luU2V0dGluZ3M7XG4gICAgcHVibGljIGpzZXNzaW9uSWQ6IHN0cmluZyB8IG51bGwgPSBudWxsO1xuXG4gICAgY29uc3RydWN0b3Ioc2V0dGluZ3M6IFRlYW1jZW50ZXJJbnRlZ3JhdG9yUGx1Z2luU2V0dGluZ3MpIHtcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IHNldHRpbmdzO1xuICAgIH1cblxuICAgIHVwZGF0ZVNldHRpbmdzKHNldHRpbmdzOiBUZWFtY2VudGVySW50ZWdyYXRvclBsdWdpblNldHRpbmdzKSB7XG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBzZXR0aW5ncztcbiAgICB9XG5cbiAgICAvLyBAdHMtaWdub3JlXG4gICAgYXN5bmMgbG9naW4odGNVcmw9dGhpcy5zZXR0aW5ncy50Y1VybCx0Y1VybFdlYlRpZXJQb3J0PXRoaXMuc2V0dGluZ3MudGNVcmxXZWJUaWVyUG9ydCxcbiAgICAgICAgICAgICAgICB0Y1dlYlRpZXJBcHBOYW1lPXRoaXMuc2V0dGluZ3MudGNXZWJUaWVyQXBwTmFtZSx1c2VyTmFtZSA9IHRoaXMuc2V0dGluZ3MudXNlck5hbWUsIHVzZXJQYXNzd29yZCA9IHRoaXMuc2V0dGluZ3MudXNlclBhc3N3b3JkKTogUHJvbWlzZTxzdHJpbmcgfCB1bmRlZmluZWQ+IHtcbiAgICAgICAgdGhpcy5qc2Vzc2lvbklkPScnO1xuICAgICAgICBjb25zdCB1cmwgPSBgJHt0Y1VybH06JHt0Y1VybFdlYlRpZXJQb3J0fS8ke3RjV2ViVGllckFwcE5hbWV9L0pzb25SZXN0U2VydmljZXMvQ29yZS0yMDExLTA2LVNlc3Npb24vbG9naW5gO1xuXG4gICAgICAgIGNvbnN0IHBheWxvYWQgPSB7XG4gICAgICAgICAgICBoZWFkZXI6IHtcbiAgICAgICAgICAgICAgICBzdGF0ZToge30sXG4gICAgICAgICAgICAgICAgcG9saWN5OiB7fVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGJvZHk6IHtcbiAgICAgICAgICAgICAgICBjcmVkZW50aWFsczoge1xuICAgICAgICAgICAgICAgICAgICB1c2VyOiB1c2VyTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgcGFzc3dvcmQ6IHVzZXJQYXNzd29yZCxcbiAgICAgICAgICAgICAgICAgICAgcm9sZTogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpbWF0b3I6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgIGxvY2FsZTogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgZ3JvdXA6IFwiXCJcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgcmVxdWVzdE9wdGlvbnM6IFJlcXVlc3RVcmxQYXJhbSA9IHtcbiAgICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICBjb250ZW50VHlwZTogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkocGF5bG9hZCksXG4gICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRocm93OiBmYWxzZVxuICAgICAgICB9O1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZTogUmVxdWVzdFVybFJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdFVybChyZXF1ZXN0T3B0aW9ucyk7XG4gICAgICAgICAgICBpZiAoIXJlc3BvbnNlLmpzb24uY29kZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNldENvb2tpZUhlYWRlciA9IHJlc3BvbnNlLmhlYWRlcnNbJ3NldC1jb29raWUnXTtcbiAgICAgICAgICAgICAgICBpZiAoc2V0Q29va2llSGVhZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBjb29raWVTdHJpbmcgPSAnJztcblxuICAgICAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShzZXRDb29raWVIZWFkZXIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiBzZXRDb29raWVIZWFkZXIgaXMgYW4gYXJyYXksIGNvbmNhdGVuYXRlIGFsbCBjb29raWVzXG4gICAgICAgICAgICAgICAgICAgICAgICBjb29raWVTdHJpbmcgPSBzZXRDb29raWVIZWFkZXIuam9pbignOyAnKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvb2tpZVN0cmluZyA9IHNldENvb2tpZUhlYWRlcjtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGpzZXNzaW9uSWRNYXRjaCA9IGNvb2tpZVN0cmluZy5tYXRjaCgvSlNFU1NJT05JRD0oW147XSspLyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChqc2Vzc2lvbklkTWF0Y2gpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuanNlc3Npb25JZCA9IGpzZXNzaW9uSWRNYXRjaFsxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdMb2dnZWQgaW4gc3VjY2Vzc2Z1bGx5LiBKU0VTU0lPTklEOicsIHRoaXMuanNlc3Npb25JZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5qc2Vzc2lvbklkO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdKU0VTU0lPTklEIG5vdCBmb3VuZCBpbiBTZXQtQ29va2llIGhlYWRlci4nKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1NldC1Db29raWUgaGVhZGVyIG5vdCBmb3VuZCBpbiByZXNwb25zZS4nKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0xvZ2luIGZhaWxlZC4gU3RhdHVzOicsIHJlc3BvbnNlLnN0YXR1cywgJ1Jlc3BvbnNlOicsIHJlc3BvbnNlLnRleHQpO1xuICAgICAgICAgICAgICAgIHJldHVybiBcIjUwMFwiO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignQW4gZXJyb3Igb2NjdXJyZWQgZHVyaW5nIGxvZ2luOicsIGVycm9yKTtcbiAgICAgICAgICAgIHJldHVybiBlcnJvcjtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFzeW5jIGxvYWRSZXZpc2lvblJ1bGUodGNVcmw9dGhpcy5zZXR0aW5ncy50Y1VybCx0Y1VybFdlYlRpZXJQb3J0PXRoaXMuc2V0dGluZ3MudGNVcmxXZWJUaWVyUG9ydCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIHRjV2ViVGllckFwcE5hbWU9dGhpcy5zZXR0aW5ncy50Y1dlYlRpZXJBcHBOYW1lKTogUHJvbWlzZTxSZXZpc2lvblJ1bGVbXT4ge1xuICAgICAgICBpZiAoIXRoaXMuanNlc3Npb25JZCkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignTm90IGxvZ2dlZCBpbi4gUGxlYXNlIGxvZ2luIGZpcnN0LicpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdOb3QgbG9nZ2VkIGluJyk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB1cmwgPSBgJHt0Y1VybH06JHt0Y1VybFdlYlRpZXJQb3J0fS8ke3RjV2ViVGllckFwcE5hbWV9L0pzb25SZXN0U2VydmljZXMvQ2FkLTIwMDctMDEtU3RydWN0dXJlTWFuYWdlbWVudC9nZXRSZXZpc2lvblJ1bGVzYDtcblxuICAgICAgICBjb25zdCBwYXlsb2FkID0ge1xuICAgICAgICAgICAgXCJoZWFkZXJcIjoge1xuICAgICAgICAgICAgICAgIFwic3RhdGVcIjoge1xuICAgICAgICAgICAgICAgICAgICBcImZvcm1hdFByb3BlcnRpZXNcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgXCJzdGF0ZWxlc3NcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgXCJ1bmxvYWRPYmplY3RzXCI6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBcImVuYWJsZVNlcnZlclN0YXRlSGVhZGVyc1wiOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBcImxvY2FsZVwiOiBcImVuX1VTXCJcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIFwicG9saWN5XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJ0eXBlc1wiOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiUmV2aXNpb25SdWxlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9wZXJ0aWVzXCI6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwib2JqZWN0X25hbWVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IHJlcXVlc3RPcHRpb25zOiBSZXF1ZXN0VXJsUGFyYW0gPSB7XG4gICAgICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgY29udGVudFR5cGU6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHBheWxvYWQpLFxuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAgICAgJ0Nvb2tpZSc6IGBKU0VTU0lPTklEPSR7dGhpcy5qc2Vzc2lvbklkfWBcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0aHJvdzogZmFsc2VcbiAgICAgICAgfTtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2U6IFJlcXVlc3RVcmxSZXNwb25zZSA9IGF3YWl0IHJlcXVlc3RVcmwocmVxdWVzdE9wdGlvbnMpO1xuXG4gICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHtcbiAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gcmVzcG9uc2UuanNvbjtcblxuICAgICAgICAgICAgICAgIGNvbnN0IHJldmlzaW9uUnVsZXM6IFJldmlzaW9uUnVsZVtdID0gW107XG5cbiAgICAgICAgICAgICAgICBjb25zdCBvdXRwdXRBcnJheSA9IGRhdGEub3V0cHV0O1xuXG4gICAgICAgICAgICAgICAgY29uc3QgbW9kZWxPYmplY3RzID0gZGF0YS5TZXJ2aWNlRGF0YT8ubW9kZWxPYmplY3RzO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KG91dHB1dEFycmF5KSB8fCAhbW9kZWxPYmplY3RzKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1VuZXhwZWN0ZWQgcmVzcG9uc2UgZm9ybWF0Jyk7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVW5leHBlY3RlZCByZXNwb25zZSBmb3JtYXQnKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG91dHB1dEl0ZW0gb2Ygb3V0cHV0QXJyYXkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmV2UnVsZVVpZCA9IG91dHB1dEl0ZW0ucmV2UnVsZT8udWlkO1xuICAgICAgICAgICAgICAgICAgICBpZiAocmV2UnVsZVVpZCAmJiBtb2RlbE9iamVjdHNbcmV2UnVsZVVpZF0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJldlJ1bGVPYmplY3QgPSBtb2RlbE9iamVjdHNbcmV2UnVsZVVpZF07XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBvYmplY3ROYW1lUHJvcHMgPSByZXZSdWxlT2JqZWN0LnByb3BzPy5vYmplY3RfbmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHVpVmFsdWVzID0gb2JqZWN0TmFtZVByb3BzPy51aVZhbHVlcztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5hbWUgPSB1aVZhbHVlcyAmJiB1aVZhbHVlc1swXSA/IHVpVmFsdWVzWzBdIDogJyc7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV2aXNpb25SdWxlcy5wdXNoKHsgdWlkOiByZXZSdWxlVWlkLCBuYW1lOiBuYW1lIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYE5vIG5hbWUgZm91bmQgZm9yIHJldmlzaW9uIHJ1bGUgd2l0aCBVSUQgJHtyZXZSdWxlVWlkfWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBSZXZpc2lvbiBydWxlIHdpdGggVUlEICR7cmV2UnVsZVVpZH0gbm90IGZvdW5kIGluIG1vZGVsT2JqZWN0c2ApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJldmlzaW9uUnVsZXM7XG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGxvYWQgcmV2aXNpb24gcnVsZXMuIFN0YXR1czonLCByZXNwb25zZS5zdGF0dXMsICdSZXNwb25zZTonLCByZXNwb25zZS50ZXh0KTtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBsb2FkIHJldmlzaW9uIHJ1bGVzJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSBsb2FkaW5nIHJldmlzaW9uIHJ1bGVzOicsIGVycm9yKTtcbiAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gRnV0dXJlIG1ldGhvZHMgd2lsbCB1c2UgdGhpcy5qc2Vzc2lvbklkIGZvciBhdXRoZW50aWNhdGVkIHJlcXVlc3RzXG59XG4iLCAiLy8gc2V0dGluZ3MudHNcblxuaW1wb3J0IHtBcHAsIERyb3Bkb3duQ29tcG9uZW50LCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nLCBUZXh0Q29tcG9uZW50fSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgdHlwZSBUZWFtY2VudGVySW50ZWdyYXRvclBsdWdpbiBmcm9tICdtYWluJztcbmltcG9ydCBUZWFtY2VudGVyQXBpLCB7UmV2aXNpb25SdWxlfSBmcm9tICcuL3RlYW1jZW50ZXJBcGknO1xuXG5leHBvcnQgaW50ZXJmYWNlIFRlYW1jZW50ZXJJbnRlZ3JhdG9yUGx1Z2luU2V0dGluZ3Mge1xuICAgIHRjVXJsOiBzdHJpbmc7XG4gICAgdGNVcmxXZWJUaWVyUG9ydDogc3RyaW5nO1xuICAgIHRjV2ViVGllckFwcE5hbWU6IHN0cmluZztcbiAgICB1c2VyTmFtZTogc3RyaW5nO1xuICAgIHVzZXJQYXNzd29yZDogc3RyaW5nO1xuICAgIHNlbGVjdGVkUmV2aXNpb25SdWxlVWlkOnN0cmluZztcbiAgICBzZWxlY3RlZFJldmlzaW9uUnVsZU5hbWU6c3RyaW5nO1xufVxuXG5leHBvcnQgY29uc3QgREVGQVVMVF9TRVRUSU5HUzogVGVhbWNlbnRlckludGVncmF0b3JQbHVnaW5TZXR0aW5ncyA9IHtcbiAgICB0Y1VybDogJycsXG4gICAgdGNVcmxXZWJUaWVyUG9ydDogJzcwMDEnLFxuICAgIHRjV2ViVGllckFwcE5hbWU6ICd0YycsXG4gICAgdXNlck5hbWU6ICcnLFxuICAgIHVzZXJQYXNzd29yZDogJycsXG4gICAgc2VsZWN0ZWRSZXZpc2lvblJ1bGVVaWQ6JycsXG4gICAgc2VsZWN0ZWRSZXZpc2lvblJ1bGVOYW1lOicnLFxufTtcblxuLy8gU2V0dGluZ3MgdGFiIGZvciB0aGUgcGx1Z2luXG5leHBvcnQgY2xhc3MgVGVhbWNlbnRlckludGVncmF0b3JTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XG4gICAgcGx1Z2luOiBUZWFtY2VudGVySW50ZWdyYXRvclBsdWdpbjtcbiAgICBwcml2YXRlIHJldmlzaW9uUnVsZXM6IFJldmlzaW9uUnVsZVtdID0gW107XG4gICAgcHJpdmF0ZSBzZWxlY3RlZFJldmlzaW9uUnVsZVVpZDogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG4gICAgcHJpdmF0ZSBzZWxlY3RlZFJldmlzaW9uUnVsZTogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBUZWFtY2VudGVySW50ZWdyYXRvclBsdWdpbikge1xuICAgICAgICBzdXBlcihhcHAsIHBsdWdpbik7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgIH1cblxuICAgIGRpc3BsYXkoKTogdm9pZCB7XG4gICAgICAgIGxldCByZXZpc2lvblJ1bGVDb250cm9sOkRyb3Bkb3duQ29tcG9uZW50O1xuICAgICAgICAvLyBEcm9wZG93biBmb3IgUmV2aXNpb24gUnVsZVxuICAgICAgICBsZXQgZHJvcGRvd25FdmVudEF0dGFjaGVkID0gZmFsc2U7XG4gICAgICAgIGNvbnN0IHtjb250YWluZXJFbH0gPSB0aGlzO1xuICAgICAgICBjb25zdCB0ZWFtY2VudGVyQXBpID0gbmV3IFRlYW1jZW50ZXJBcGkoREVGQVVMVF9TRVRUSU5HUyk7XG4gICAgICAgIGNvbnRhaW5lckVsLmVtcHR5KCk7XG5cbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2gyJywge3RleHQ6ICdUZWFtY2VudGVyIEludGVncmF0aW9uIFNldHRpbmdzJ30pO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ1RDX1VSTCcpXG4gICAgICAgICAgICAuc2V0RGVzYygnQmFzZSBVUkwgb2YgeW91ciBUZWFtY2VudGVyIHNlcnZlci4nKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdFbnRlciBUQ19VUkwnKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy50Y1VybClcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnRjVXJsID0gdmFsdWUudHJpbSgpO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnVENVUkxfV0VCVElFUl9BUFBfTkFNRScpXG4gICAgICAgICAgICAuc2V0RGVzYygnV2ViIHRpZXIgYXBwbGljYXRpb24gbmFtZSAodHlwaWNhbGx5OiB0YykuJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignRW50ZXIgVENVUkxfV0VCVElFUl9BUFBfTkFNRScpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnRjV2ViVGllckFwcE5hbWUpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy50Y1dlYlRpZXJBcHBOYW1lID0gdmFsdWUudHJpbSgpO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnVENVUkxfV0VCVElFUl9QT1JUJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdXZWIgdGllciBwb3J0IG9mIHlvdXIgVGVhbWNlbnRlciBzZXJ2ZXIgKHR5cGljYWxseTogNzAwMSkuJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignRW50ZXIgVENVUkxfV0VCVElFUl9QT1JUJylcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MudGNVcmxXZWJUaWVyUG9ydClcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnRjVXJsV2ViVGllclBvcnQgPSB2YWx1ZS50cmltKCk7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdVc2VyIE5hbWUnKVxuICAgICAgICAgICAgLnNldERlc2MoJ1lvdXIgVGVhbWNlbnRlciB1c2VybmFtZS4nKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdFbnRlciB5b3VyIHVzZXJuYW1lJylcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MudXNlck5hbWUpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy51c2VyTmFtZSA9IHZhbHVlLnRyaW0oKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ1Bhc3N3b3JkJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdZb3VyIFRlYW1jZW50ZXIgcGFzc3dvcmQuJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4ge1xuICAgICAgICAgICAgICAgIHRleHQuc2V0UGxhY2Vob2xkZXIoJ0VudGVyIHlvdXIgcGFzc3dvcmQnKVxuICAgICAgICAgICAgICAgICAgICAuc2V0RGlzYWJsZWQodHJ1ZSlcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnVzZXJQYXNzd29yZClcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MudXNlclBhc3N3b3JkID0gdmFsdWUudHJpbSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5hZGRCdXR0b24oYnV0dG9uID0+IHtcbiAgICAgICAgICAgICAgICBidXR0b24uc2V0QnV0dG9uVGV4dCgnQ2hlY2sgVGVhbWNlbnRlciBsb2dpbi9wYXNzd29yZCcpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRDdGEoKVxuICAgICAgICAgICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRlYW1jZW50ZXJBcGkubG9naW4odGhpcy5wbHVnaW4uc2V0dGluZ3MudGNVcmwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnRjVXJsV2ViVGllclBvcnQsIHRoaXMucGx1Z2luLnNldHRpbmdzLnRjV2ViVGllckFwcE5hbWUsIHRoaXMucGx1Z2luLnNldHRpbmdzLnVzZXJOYW1lLCB0aGlzLnBsdWdpbi5zZXR0aW5ncy51c2VyUGFzc3dvcmQpLnRoZW4obG9naW5SZXN1bHQgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImxvZ2luUmVzdWx0OiBcIiArIGxvZ2luUmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxvZ2luUmVzdWx0IT09XCI1MDBcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV2aXNpb25SdWxlQ29udHJvbC5zZXREaXNhYmxlZChmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV2aXNpb25SdWxlQ29udHJvbC5zZXREaXNhYmxlZCh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ1JldmlzaW9uIFJ1bGUnKVxuICAgICAgICAgICAgLmFkZERyb3Bkb3duKGRyb3Bkb3duID0+IHtcbiAgICAgICAgICAgICAgICAvLyBTdG9yZSBhIHJlZmVyZW5jZSB0byB0aGUgZHJvcGRvd24gY29tcG9uZW50XG4gICAgICAgICAgICAgICAgcmV2aXNpb25SdWxlQ29udHJvbCA9IGRyb3Bkb3duO1xuICAgICAgICAgICAgICAgIGlmKHRoaXMucGx1Z2luLnNldHRpbmdzLnNlbGVjdGVkUmV2aXNpb25SdWxlTmFtZSl7XG4gICAgICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbih0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWxlY3RlZFJldmlzaW9uUnVsZVVpZCwgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VsZWN0ZWRSZXZpc2lvblJ1bGVOYW1lKTtcbiAgICAgICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgLy8gQWRkIGEgZGVmYXVsdCBvcHRpb25cbiAgICAgICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKCcnLCAnU2VsZWN0IGEgcmV2aXNpb24gcnVsZScpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBEaXNhYmxlIHRoZSBkcm9wZG93biBpbml0aWFsbHlcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5zZXREaXNhYmxlZCh0cnVlKTtcblxuICAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIHJldmlzaW9uIHJ1bGVzIGFyZSBhbHJlYWR5IGxvYWRlZCAoZS5nLiwgZnJvbSBwcmV2aW91cyBzZXNzaW9ucylcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5yZXZpc2lvblJ1bGVzICYmIHRoaXMucmV2aXNpb25SdWxlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFBvcHVsYXRlIHRoZSBkcm9wZG93biB3aXRoIGV4aXN0aW5nIHJldmlzaW9uIHJ1bGVzXG4gICAgICAgICAgICAgICAgICAgIHBvcHVsYXRlRHJvcGRvd25XaXRoUmV2aXNpb25SdWxlcyhkcm9wZG93biwgdGhpcy5yZXZpc2lvblJ1bGVzKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBTZXQgdGhlIHNlbGVjdGVkIHZhbHVlIGlmIG9uZSBleGlzdHNcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLnNlbGVjdGVkUmV2aXNpb25SdWxlVWlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkcm9wZG93bi5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWxlY3RlZFJldmlzaW9uUnVsZVVpZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gRW5hYmxlIHRoZSBkcm9wZG93blxuICAgICAgICAgICAgICAgICAgICBkcm9wZG93bi5zZXREaXNhYmxlZChmYWxzZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQXR0YWNoIHRoZSBldmVudCBsaXN0ZW5lciBvbmx5IG9uY2VcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFkcm9wZG93bkV2ZW50QXR0YWNoZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRyb3Bkb3duRXZlbnRBdHRhY2hlZCA9IHRydWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGRyb3Bkb3duLnNlbGVjdEVsLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIGFzeW5jIChldmVudCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5yZXZpc2lvblJ1bGVzIHx8IHRoaXMucmV2aXNpb25SdWxlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsgLy8gUHJldmVudCB0aGUgZHJvcGRvd24gZnJvbSBvcGVuaW5nXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2hvdyAnTG9hZGluZy4uLicgbWVzc2FnZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oJycsICdMb2FkaW5nLi4uJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRyb3Bkb3duLnNldFZhbHVlKCcnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHJvcGRvd24uc2VsZWN0RWwuZGlzYWJsZWQgPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBMb2FkIHJldmlzaW9uIHJ1bGVzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJldmlzaW9uUnVsZXMgPSBhd2FpdCB0ZWFtY2VudGVyQXBpLmxvYWRSZXZpc2lvblJ1bGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MudGNVcmwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MudGNVcmxXZWJUaWVyUG9ydCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy50Y1dlYlRpZXJBcHBOYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBQb3B1bGF0ZSB0aGUgZHJvcGRvd24gd2l0aCBsb2FkZWQgcmV2aXNpb24gcnVsZXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvcHVsYXRlRHJvcGRvd25XaXRoUmV2aXNpb25SdWxlcyhkcm9wZG93biwgdGhpcy5yZXZpc2lvblJ1bGVzKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRW5hYmxlIHRoZSBkcm9wZG93blxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHJvcGRvd24uc2VsZWN0RWwuZGlzYWJsZWQgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gT3BlbiB0aGUgZHJvcGRvd24gYWZ0ZXIgbG9hZGluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHJvcGRvd24uc2VsZWN0RWwuY2xpY2soKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2V0IHRoZSBzZWxlY3RlZCB2YWx1ZSBpZiBvbmUgZXhpc3RzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VsZWN0ZWRSZXZpc2lvblJ1bGVVaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkcm9wZG93bi5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWxlY3RlZFJldmlzaW9uUnVsZVVpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gbG9hZCByZXZpc2lvbiBydWxlczonLCBlcnJvcik7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNob3cgZXJyb3IgbWVzc2FnZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkT3B0aW9uKCcnLCAnRmFpbGVkIHRvIGxvYWQgcmV2aXNpb24gcnVsZXMnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRyb3Bkb3duLnNldFZhbHVlKCcnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRyb3Bkb3duLnNlbGVjdEVsLmRpc2FibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIEhhbmRsZSB0aGUgZHJvcGRvd24gdmFsdWUgY2hhbmdlXG4gICAgICAgICAgICAgICAgZHJvcGRvd24ub25DaGFuZ2UoYXN5bmMgdmFsdWUgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyBTYXZlIHRoZSBVSURcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VsZWN0ZWRSZXZpc2lvblJ1bGVVaWQgPSB2YWx1ZTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIHRoZSBjb3JyZXNwb25kaW5nIGRpc3BsYXkgbmFtZVxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RlZFJ1bGUgPSB0aGlzLnJldmlzaW9uUnVsZXMuZmluZChydWxlID0+IHJ1bGUudWlkID09PSB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnNlbGVjdGVkUmV2aXNpb25SdWxlTmFtZSA9IHNlbGVjdGVkUnVsZSA/IHNlbGVjdGVkUnVsZS5uYW1lIDogJyc7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gU2F2ZSBzZXR0aW5nc1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4vLyBIZWxwZXIgZnVuY3Rpb24gdG8gcG9wdWxhdGUgdGhlIGRyb3Bkb3duIHdpdGggcmV2aXNpb24gcnVsZXNcbiAgICAgICAgZnVuY3Rpb24gcG9wdWxhdGVEcm9wZG93bldpdGhSZXZpc2lvblJ1bGVzKGRyb3Bkb3duOiBEcm9wZG93bkNvbXBvbmVudCwgcmV2aXNpb25SdWxlczogYW55W10pIHtcbiAgICAgICAgICAgIC8vIENsZWFyIGV4aXN0aW5nIG9wdGlvbnNcbiAgICAgICAgICAgIGRyb3Bkb3duLnNlbGVjdEVsLmlubmVySFRNTCA9ICcnO1xuXG4gICAgICAgICAgICAvLyBBZGQgZGVmYXVsdCBvcHRpb25cbiAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbignJywgJ1NlbGVjdCBhIHJldmlzaW9uIHJ1bGUnKTtcblxuICAgICAgICAgICAgLy8gQWRkIHJldmlzaW9uIHJ1bGUgb3B0aW9uc1xuICAgICAgICAgICAgZm9yIChjb25zdCBydWxlIG9mIHJldmlzaW9uUnVsZXMpIHtcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24ocnVsZS51aWQsIHJ1bGUubmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59Il0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLElBQUFBLG1CQUE2Qzs7O0FDRTdDLElBQUFDLG1CQUFtQzs7O0FDQW5DLHNCQUFnRTtBQWVoRSxJ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ZUFBVyxRQUFRLE9BQU87QUFDekIsWUFBTSxVQUFVLEtBQUssY0FBYyxLQUFLLElBQUk7QUFDNUMsWUFBTSxLQUFLLHNCQUFzQixLQUFLLE1BQU0sT0FBTztBQUFBLElBQ3BEO0FBQUEsRUFDRDtBQUFBLEVBRUEsTUFBTSx3QkFBd0IsWUFBb0I7QUFDakQscUJBQWEsZ0NBQWMsVUFBVTtBQUNyQyxRQUFJLENBQUMsS0FBSyxJQUFJLE1BQU0sc0JBQXNCLFVBQVUsR0FBRztBQUN0RCxZQUFNLEtBQUssSUFBSSxNQUFNLGFBQWEsVUFBVTtBQUFBLElBQzdDO0FBQUEsRUFDRDtBQUFBLEVBRUEsTUFBTSxzQkFBc0IsVUFBa0IsU0FBaUI7QUFDOUQsbUJBQVcsZ0NBQWMsUUFBUTtBQUNqQyxRQUFJLENBQUMsS0FBSyxJQUFJLE1BQU0sc0JBQXNCLFFBQVEsR0FBRztBQUNwRCxZQUFNLEtBQUssSUFBSSxNQUFNLE9BQU8sVUFBVSxPQUFPO0FBQUEsSUFDOUM7QUFBQSxFQUNEO0FBQUEsRUFFQSxjQUFjLE1BQXlDO0FBQ3RELFVBQU0sVUFBVTtBQUNoQixRQUFJLE9BQU87QUFDWCxlQUFXLE9BQU8sTUFBTTtBQUN2QixjQUFRLEtBQUssZ0JBQWdCLEtBQUssR0FBRztBQUFBO0FBQUEsSUFDdEM7QUFDQSxXQUFPLFVBQVU7QUFBQSxFQUNsQjtBQUNEOyIsCiAgIm5hbWVzIjogWyJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiJdCn0K
